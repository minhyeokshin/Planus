<!-- Thymeleaf template for Submenu Page -->
<!-- (서브메뉴 페이지용 타임리프 템플릿) -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{user/common/layouts/defaultLayout}">
  <!-- Inherit layout from default admin layout -->
  <!-- (기본 관리자 레이아웃 상속) -->
<head>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
</head>
<body>

<div layout:fragment="content">
    <!-- Main content area to be injected into layout -->
    <!-- (레이아웃에 삽입될 주요 콘텐츠 영역) -->
    <div style="display: flex; gap: 20px;">
      <!-- Calendar section -->
      <div style="flex: 2;">
        <div id="calendar" style="margin-top: 20px;"></div>
      </div>

      <!-- Today's tasks sidebar -->
      <div style="flex: 1; margin-top: 20px;">
        <h3>오늘의 할 일</h3>
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="background-color: #f2f2f2;">
              <th style="padding: 8px; border: 1px solid #ddd;">제목</th>
              <th style="padding: 8px; border: 1px solid #ddd;">담당자</th>
              <th style="padding: 8px; border: 1px solid #ddd;">완료</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 8px; border: 1px solid #ddd;">회의 준비</td>
              <td style="padding: 8px; border: 1px solid #ddd;">홍길동</td>
              <td style="padding: 8px; border: 1px solid #ddd;">❌</td>
            </tr>
            <tr>
              <td style="padding: 8px; border: 1px solid #ddd;">코드 리뷰</td>
              <td style="padding: 8px; border: 1px solid #ddd;">김개발</td>
              <td style="padding: 8px; border: 1px solid #ddd;">✅</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const calendarEl = document.getElementById('calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          height: 700,
          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },
          events: [
            {
              title: '예시 일정',
              start: new Date().toISOString().split('T')[0]
            }
          ],
          dateClick: function(info) {
            const title = prompt('일정 제목을 입력하세요:');
            if (title) {
              fetch('/api/schedule', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  title: title,
                  date: info.dateStr
                })
              }).then(response => {
                if (response.ok) {
                  calendar.addEvent({
                    title: title,
                    start: info.dateStr,
                    allDay: true
                  });
                } else {
                  alert('일정 저장 실패');
                }
              });
            }
          }
        });
        calendar.render();
      });
    </script>
</div>


</body>
</html>